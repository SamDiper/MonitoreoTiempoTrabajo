<div class="min-h-dvh w-full px-4 py-6 flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-evenly overflow-y-auto">
  <!-- Columna 1: Trabajador y métricas -->
  <div class="w-full lg:w-1/3 flex flex-col gap-4 text-gray-900 font-bold text-center">
    <h1 class="bg-gray-800 text-white p-3 font-bold rounded-2xl flex items-center justify-between">
      <select 
        (change)="mapInfoTrabajador($event)"
        class="appearance-none block w-full cursor-pointer text-lg py-3 px-4 pr-10 bg-white text-gray-800 border border-gray-300 rounded-lg"
      >
        <option value="" disabled selected>Seleccione un trabajador</option>

        @for (item of this.publicFuncion.procesarDatosPorTrabajador(registrosTrabajadores); track item.nombre) {
          <option class="font-black text-white in-hover:bg-gray-800" value="{{ item.nombre }}">
            {{ item.nombre }}
          </option>
        }
      </select>
    </h1>

    <div class="flex flex-row gap-4 items-center justify-evenly">
      <!-- PROFILE -->
      <div class="bg-gray-800 w-1/3 border-4 border-gray-900 rounded-full text-gray-900 px-3 py-3 shrink-0">
        <div class="bg-gray-800 w-full h-full border-4 border-white rounded-full text-white px-1 py-8 text-5xl shrink-0">{{inicialNombre}}</div>
      </div>
      <!-- INFO -->
      <div class="w-2/3 flex flex-col gap-4">
        <p class="text-white font-bold text-center bg-gray-800 rounded-4xl">TOTAL HORAS TRABAJADAS </p>
        <span class="bg-white text-gray-800">{{ publicFuncion.parseHoursMinute(totalHorasTrabajadas)}}</span>
        <p class="text-white font-bold text-center bg-gray-800 rounded-4xl">PORCENTAJE DE ASISTENCIAS </p>
        <span>{{ porcentajeAsistencias }}%</span>
      </div>
    </div>

    <div class="flex flex-row gap-4 items-center">
      <div class="w-full lg:w-1/3 flex flex-col text-gray-900 font-bold">
        <div class="items-center">
          <h2 class="bg-gray-800 h-1/2 text-white rounded-2xl p-3 mb-5 w-full">PROMEDIO HORA DE LLEGADA</h2>
          <div class="bg-transparent border-4 border-gray-900 rounded-full text-gray-900 px-3 py-12 shrink-0 text-2xl">{{promedioHoraEntrada}}</div>
        </div>
      </div>
      <div class="w-full lg:w-1/3 flex flex-col text-gray-900 font-bold">
        <div class="items-center">
          <h2 class="bg-gray-800 h-1/2 text-white rounded-2xl p-3 mb-5 w-full">PROMEDIO HORA DE SALIDA</h2>
          <div class="bg-transparent border-4 border-gray-900 rounded-full text-gray-900 px-3 py-12 shrink-0 text-2xl">{{promedioHoraSalida}}</div>
        </div>
      </div>
      <div class="w-full lg:w-1/3 flex flex-col text-gray-900 font-bold">
        <div class="items-center">
          <h2 class="bg-gray-800 h-1/2 text-white rounded-2xl p-2 mb-5 w-full text-sm">PROMEDIO DE HORAS TRABAJADAS DIARIAS</h2>
          <div class="bg-transparent border-4 border-gray-900 rounded-full text-gray-900 px-3 py-12 shrink-0 text-2xl">{{publicFuncion.parseHoursMinute(promedioHorasTrabajadas)}}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Columna 3: Calendario -->
  <div class="w-full lg:w-1/3">
    <h1 class="bg-gray-800 text-white p-3 font-bold rounded-2xl flex items-center justify-between">
      <span>CALENDARIO</span>
    </h1>

    <div class="mt-4 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <button (click)="prevMonth()" class="px-2 py-1 rounded hover:bg-gray-100" aria-label="Mes anterior">‹</button>
        <button (click)="goToday()" class="px-3 py-1 rounded bg-gray-800 text-white">Hoy</button>
        <button (click)="nextMonth()" class="px-2 py-1 rounded hover:bg-gray-100" aria-label="Mes siguiente">›</button>
      </div>
      <h2 class="text-lg font-semibold">
        {{ current() | date:'MMMM y' }}
      </h2>
    </div>

    <div class="mt-2 grid grid-cols-7 text-xs font-medium text-gray-500">
      <div class="py-2 text-center">Lun</div>
      <div class="py-2 text-center">Mar</div>
      <div class="py-2 text-center">Mié</div>
      <div class="py-2 text-center">Jue</div>
      <div class="py-2 text-center">Vie</div>
      <div class="py-2 text-center">Sáb</div>
      <div class="py-2 text-center">Dom</div>
    </div>

    <div class="grid grid-cols-7 gap-px bg-gray-200 auto-rows-[minmax(5rem,1fr)]">
      @for (day of monthDays(); track $index) {
        <div class="bg-white p-2 relative">
          <div class="text-xs"
               [class.text-gray-400]="!isSameMonth(day, current())"
               [class.font-semibold]="isToday(day)"
               [class.text-amber-600]="isToday(day)">
            {{ day | date:'d' }}
          </div>

          @if (day.getDate() === 23) {
            <p class="text-4xl text-red-500">●</p>
          } @else if (day.getDate() === 15) {
            <p class="text-4xl text-amber-400">●</p>
          } @else {
            <p class="text-4xl text-gray-700">●</p>
          }
        </div>
      }
    </div>

    <div class="flex flex-row justify-evenly mt-4 text-center text-black font-bold">
      <div><span class="text-4xl text-gray-700">●</span><p>NORMAL</p></div>
      <div><span class="text-4xl text-red-500">●</span><p>FALTA</p></div>
      <div><span class="text-4xl text-amber-400">●</span><p>NOVEDAD</p></div>
    </div>
  </div>

</div>
<div class="mb-10 flex flex-col lg:flex-row lg:items-center lg:justify-evenly">
  <!-- Columna 2: Charts -->
  <div class="w-full lg:w-1/3">
    <h1 class="bg-gray-800 text-white p-3 font-bold rounded-2xl flex items-center justify-between">
      <span>CHARTS</span>
    </h1>

    <div class="mt-4 h-64 bg-white rounded-xl shadow p-3">
      <canvas baseChart [type]="'bar'" [data]="barData" [options]="barOptions"></canvas>
    </div>
  </div>
</div>
